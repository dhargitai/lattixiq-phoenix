# Story 1.1: Initialize Turborepo Monorepo Structure

## Status
Ready for Review

## Story
**As a** developer,
**I want** a properly configured Turborepo monorepo structure with clear separation of concerns,
**so that** I can build the Phoenix Framework with decoupled core logic and scalable package management

## Acceptance Criteria
1. Turborepo monorepo is initialized with v2.5.6 configuration
2. Root-level directory structure follows the unified project structure specification
3. `apps/web/` directory is created and configured for Next.js v15.5 application
4. `packages/core/` directory is created for the Phoenix Core Engine (TypeScript only)
5. `packages/ui/` directory is created for shared UI components and theme config
6. `packages/config/` directory is created for shared configurations (ESLint, TypeScript)
7. Root `package.json` includes Turborepo build, dev, and lint scripts
8. TypeScript configuration enables type sharing between packages
9. Build system works across all packages with `turbo run build`
10. Development workflow supports running the web app with `turbo run dev`

## Tasks / Subtasks
- [x] Task 1: Initialize Turborepo workspace (AC: 1, 2, 7)
  - [x] Install Turborepo v2.5.6 globally or as devDependency
  - [x] Initialize turbo.json configuration file with build and dev pipeline
  - [x] Configure root package.json with workspace definitions and turbo scripts
- [x] Task 2: Create core package structure (AC: 2, 4)
  - [x] Create `packages/core/` directory with package.json
  - [x] Set up TypeScript configuration in packages/core
  - [x] Create initial src/ directory structure in core package
  - [x] Add core package exports for type definitions
- [x] Task 3: Create web application structure (AC: 2, 3, 10)
  - [x] Create `apps/web/` directory with Next.js v15.5 configuration
  - [x] Configure web app package.json with Next.js dependencies
  - [x] Set up basic Next.js app structure (app router)
  - [x] Configure web app to import types from packages/core
- [x] Task 4: Create shared packages (AC: 2, 5, 6)
  - [x] Create `packages/ui/` directory structure with package.json
  - [x] Create `packages/config/` directory with shared ESLint and TypeScript configs
  - [x] Configure shared configurations for reuse across packages
- [x] Task 5: Verify monorepo integration (AC: 8, 9, 10)
  - [x] Test TypeScript compilation across all packages
  - [x] Verify `turbo run build` works for all packages
  - [x] Verify `turbo run dev` starts Next.js development server
  - [x] Test cross-package type imports work correctly

## Dev Notes

### Previous Story Insights
No specific guidance found in architecture docs - this is the first story

### Data Models
From architecture docs, the following TypeScript interfaces need to be defined in packages/core:
- User interface with UUID, email, timestamps, and user preference fields [Source: architecture/data-models.md#User]
- DecisionSprint interface for storing problem briefs and commitment memos [Source: architecture/data-models.md#DecisionSprint]
- KnowledgeContent interface for mental models with 1536-dimensional vector embeddings [Source: architecture/data-models.md#KnowledgeContent]

### API Specifications
No specific guidance found in architecture docs - API endpoints will be defined in later stories

### Component Specifications
No specific guidance found in architecture docs - UI components will be defined in later stories

### File Locations
Based on unified project structure [Source: architecture/unified-project-structure.md]:
- Root monorepo with Turborepo configuration
- `apps/web/` - Next.js frontend application with app/ router structure
- `packages/core/` - Phoenix Core Engine with src/ directory for decoupled TypeScript logic
- `packages/ui/` - Shared UI components and theme configuration
- `packages/config/` - Shared ESLint and TypeScript configurations

### Testing Requirements
No specific guidance found in architecture docs - testing strategy will be defined in later stories

### Technical Constraints
From tech stack specification [Source: architecture/tech-stack.md]:
- Node.js v24 runtime requirement
- Turborepo v2.5.6 for monorepo management  
- Next.js v15.5 for web application framework
- Strict decoupling requirement: packages/core must not contain React or DOM-specific code [Source: architecture/coding-standards.md]
- Type sharing: All shared data structures must be defined in packages/core and imported by apps/web [Source: architecture/coding-standards.md]

## Testing
### Testing Standards
No specific testing standards found in architecture docs for this foundational setup story

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-25 | 1.0 | Initial story creation | Scrum Master |

## Dev Agent Record

### Agent Model Used
claude-opus-4-1-20250805

### Debug Log References
No debug logs required for foundational monorepo setup

### Completion Notes List
- Successfully installed Turborepo v2.5.6 and configured monorepo structure
- Created pnpm-workspace.yaml for proper workspace management
- All packages build and typecheck successfully with cross-package type imports working
- Development server starts correctly on localhost:3000
- Fixed camelCase/snake_case property name mismatches in existing code
- All acceptance criteria verified and confirmed working

### File List
**Created:**
- `turbo.json` - Turborepo configuration with build and dev pipeline
- `pnpm-workspace.yaml` - pnpm workspace configuration
- `tsconfig.json` - Root TypeScript configuration with project references
- `packages/core/package.json` - Core package configuration
- `packages/core/tsconfig.json` - Core TypeScript configuration
- `packages/core/src/index.ts` - Core package entry point
- `packages/core/src/types/index.ts` - Core type definitions (User, DecisionSprint, KnowledgeContent, etc.)
- `packages/ui/package.json` - UI package configuration
- `packages/ui/tsconfig.json` - UI TypeScript configuration  
- `packages/ui/src/index.ts` - UI package entry point
- `packages/config/package.json` - Config package configuration
- `packages/config/tsconfig-base.json` - Shared TypeScript base configuration
- `packages/config/eslint-base.js` - Shared ESLint base configuration
- `apps/web/package.json` - Web app package configuration

**Modified:**
- Root `package.json` - Added Turborepo scripts and workspace configuration
- `apps/web/tsconfig.json` - Added workspace paths and project references
- `apps/web/src/lib/types/ai.ts` - Updated to import from @phoenix/core
- `apps/web/src/lib/supabase/types.ts` - Added core type imports for consistency
- `apps/web/src/lib/ai/embeddings-service.ts` - Fixed property names to match camelCase core types

**Moved:**
- Existing Next.js files moved from root to `apps/web/` directory structure

## QA Results
*Results from QA Agent review will be populated here*